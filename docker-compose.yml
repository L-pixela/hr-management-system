version: "3.8"

services:
  auth-service:
    build: ./auth-service
    ports:
      - "4000:4000"
    env_file:
      - ./auth-service/.env
    depends_on:
      - mongo
    networks:
      - cadt_net

  employee-service:
    build: ./employee_service
    ports:
      - "4001:4001"
    env_file:
      - ./employee_service/.env
    depends_on:
      - mongo
      - auth-service
    networks:
      - cadt_net

  performance-service:
    build: ./performance-service
    ports:
      - "4002:4002"
    env_file:
      - ./performance-service/.env
    depends_on:
      - mongo
      - auth-service
    networks:
      - cadt_net

  frontend-service:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: project-frontend-1
    networks:
      - cadt_net
    depends_on:
      - auth-service
      - employee-service
      - performance-service

  nginx:
    image: nginx:stable-alpine
    ports:
      - "80:80"
    volumes:
      - ./docker/nginx/default.conf:/etc/nginx/conf.d/default.conf:ro
    depends_on:
      - auth-service
      - employee-service
      - performance-service
      - frontend-service
    networks:
      - cadt_net

  mongo:
    image: mongo:7
    ports:
      - "27017:27017"
    volumes:
      - mongo-data:/data/db
    networks:
      - cadt_net

volumes:
  mongo-data:


networks:
  cadt_net:
    driver: bridge
